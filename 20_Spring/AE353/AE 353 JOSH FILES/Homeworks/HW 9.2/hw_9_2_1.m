clear, clc
%% Insert provided data
L = 2;      % Change for number of b and a it wants in matrix
w = [0.0100000000 0.0130102522 0.0169266662 0.0220220195 0.0286512027 0.0372759372 0.0484969343 0.0630957344 0.0820891416 0.1068000433 0.1389495494 0.1807768677 0.2351952635 0.3059949687 0.3981071706 0.5179474679 0.6738627168 0.8767123873 1.1406249239 1.4839817890 1.9306977289 2.5118864315 3.2680275894 4.2517863034 5.5316811976 7.1968567300 9.3632920882 12.1818791201 15.8489319246 20.6198600950 26.8269579528 34.9025487896 45.4090961097 59.0783791159 76.8624610040 100.0000000000];
mag = [1.3794436560 1.3793063036 1.3790642174 1.3788431516 1.3779310836 1.3769633567 1.3749705134 1.3717656595 1.3664867535 1.3574656086 1.3425012786 1.3187395812 1.2810126375 1.2241967157 1.1429281599 1.0362596406 0.9088922169 0.7712287721 0.6364208619 0.5136819230 0.4090220030 0.3229062558 0.2536313169 0.1985063137 0.1548000842 0.1203918269 0.0934252551 0.0720585934 0.0557251536 0.0427065399 0.0328743825 0.0254713528 0.0196003896 0.0150795664 0.0114300024 0.0087603739];
ang = [0.0222471828 0.0292241254 0.0378834618 0.0494122986 0.0639637158 0.0833217844 0.1084234533 0.1407488389 0.1828695527 0.2372143030 0.3069068074 0.3955154469 0.5070261550 0.6439271059 0.8083197235 0.9985358475 1.2112094520 1.4419894641 1.6884271541 1.9508100473 2.2300523397 2.5253972174 2.8303307515 3.1330468507 -2.8651045947 -2.6104323079 -2.3932522324 -2.2148198586 -2.0713625123 -1.9581544210 -1.8697338437 -1.8011980142 -1.7481567349 -1.7071819043 -1.6758190657 -1.6514772504];

%% Calculations:
s = 1j * w;
H = mag .* exp(1j * ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P=[P;t];
end
r = [];
for i=1:length(H)
    r=[r;s(i)^L*H(i)];
end

P = [real(P);
     imag(P)];
r = [real(r);
     imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)