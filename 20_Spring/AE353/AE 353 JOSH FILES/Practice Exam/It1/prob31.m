clear, clc

L = 3;
w = [0.0100000000 0.0162377674 0.0263665090 0.0428133240 0.0695192796 0.1128837892 0.1832980711 0.2976351442 0.4832930239 0.7847599704 1.2742749857 2.0691380811 3.3598182863 5.4555947812 8.8586679041 14.3844988829 23.3572146909 37.9269019073 61.5848211066 100.0000000000];
mag = [1.7998378964 1.8001560220 1.8011937093 1.8036740255 1.8105887720 1.8290805421 1.8767021975 1.9999091448 2.2853455622 2.5054098907 1.7255409181 1.0350456468 0.6861967535 0.4661371738 0.3066104791 0.1948701364 0.1217085625 0.0754011268 0.0464626363 0.0287976035];
ang = [3.1208713176 3.1080127761 3.0871363425 3.0531038743 2.9976924144 2.9075047682 2.7584978948 2.5074083179 2.0551898585 1.2104202254 0.2444756353 -0.3225052570 -0.6775392003 -0.9518909110 -1.1637318742 -1.3124987053 -1.4096000429 -1.4712882445 -1.5091117602 -1.5328204260];

s = 1j * w;
H = mag .* exp(1j * ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P=[P;t];
end
r = [];
for i=1:length(H)
    r=[r;s(i)^L*H(i)];
end

P = [real(P);
     imag(P)];
r = [real(r);
     imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)

