function FindCost
A = [0.40000000 0.40000000 -0.20000000; 0.10000000 -0.60000000 -0.60000000; 0.80000000 -0.30000000 -0.20000000];
B = [-0.30000000; -0.80000000; 0.00000000];
K = [-36.29363450 3.23511294 0.39425051];
Q = [0.05000000 0.00000000 0.00000000; 0.00000000 0.23000000 0.00000000; 0.00000000 0.00000000 0.97000000];
R = [0.85000000];
t0 = 0.10000000;
x0 = [0.40000000; 0.91000000; -0.63000000];
cost = integral(@(t) integrand(t, A, B, K, t0, x0, Q, R), t0, Inf);
disp(mat2str(cost, 8));
end

function cost = integrand(t, A, B, K, t0, x0, Q, R)
cost = zeros(size(t));
for i = 1:length(t)
    x = expm((A - B * K) * (t(i) - t0)) * x0;
    u = -K * x;
    cost(i) = transpose(x)*Q*x + transpose(u)*R*u;
end
end