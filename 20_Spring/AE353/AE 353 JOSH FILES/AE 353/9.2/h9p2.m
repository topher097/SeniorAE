clear; clc;

L = 3

w = [0.0100000000 0.0122167735 0.0149249555 0.0182334800 0.0222754295 0.0272133877 0.0332459793 0.0406158599 0.0496194760 0.0606189899 0.0740568469 0.0904735724 0.1105295141 0.1350314038 0.1649648074 0.2015337686 0.2462092401 0.3007882518 0.3674661941 0.4489251258 0.5484416576 0.6700187504 0.8185467307 1.0000000000 1.2216773490 1.4924955451 1.8233480009 2.2275429520 2.7213387684 3.3245979323 4.0615859884 4.9619476030 6.0618989935 7.4056846923 9.0473572423 11.0529514113 13.5031403787 16.4964807410 20.1533768594 24.6209240149 30.0788251804 36.7466194074 44.8925125822 54.8441657612 67.0018750351 81.8546730707 100.0000000000];
mag = [0.8388804805 0.8388192040 0.8390433821 0.8389733967 0.8393586182 0.8398591797 0.8402835828 0.8407889680 0.8417750417 0.8435502875 0.8455688410 0.8490187168 0.8541579018 0.8616486749 0.8722469047 0.8874705069 0.9094844593 0.9395066340 0.9781813300 1.0243096180 1.0710440804 1.1022133495 1.0978079164 1.0451488046 0.9533125127 0.8430817776 0.7328031695 0.6307535581 0.5395233204 0.4586893580 0.3872429356 0.3247747890 0.2706842112 0.2245050663 0.1855449000 0.1530804651 0.1256491699 0.1031671131 0.0845907353 0.0695143999 0.0568777752 0.0466591148 0.0380168760 0.0311913452 0.0256456428 0.0208004297 0.0172484213];
ang = [3.1082523265 3.1005982346 3.0915206455 3.0803694728 3.0668927331 3.0502712689 3.0299862682 3.0052577939 2.9753492365 2.9386392572 2.8933743687 2.8386916640 2.7721646423 2.6913861609 2.5934885586 2.4751024062 2.3326175188 2.1625185451 1.9603337874 1.7226446776 1.4476166631 1.1378006128 0.8066170755 0.4761471666 0.1707415119 -0.0955319421 -0.3216163888 -0.5130091152 -0.6764377971 -0.8172550032 -0.9390232295 -1.0437705633 -1.1332574110 -1.2089681126 -1.2724356721 -1.3253526490 -1.3692763541 -1.4052074966 -1.4352079650 -1.4596961278 -1.4796912081 -1.4961352646 -1.5096268777 -1.5206617562 -1.5299363206 -1.5372164593 -1.5434177262];

s = 1j * w;
H = mag .* exp(1j * ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P=[P;t];
end
r = [];
for i=1:length(H)
    r=[r;s(i)^L*H(i)];
end

P = [real(P);
     imag(P)];
r = [real(r);
     imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end
disp(mat2str(b))
a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
disp(mat2str(a))