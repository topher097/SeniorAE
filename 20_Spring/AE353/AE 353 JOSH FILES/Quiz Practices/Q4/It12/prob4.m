clear, clc

L = 3;
w = [0.0100000000 0.0129154967 0.0166810054 0.0215443469 0.0278255940 0.0359381366 0.0464158883 0.0599484250 0.0774263683 0.1000000000 0.1291549665 0.1668100537 0.2154434690 0.2782559402 0.3593813664 0.4641588834 0.5994842503 0.7742636827 1.0000000000 1.2915496650 1.6681005372 2.1544346900 2.7825594022 3.5938136638 4.6415888336 5.9948425032 7.7426368268 10.0000000000 12.9154966501 16.6810053720 21.5443469003 27.8255940221 35.9381366380 46.4158883361 59.9484250319 77.4263682681 100.0000000000];
mag = [0.1261889775 0.1261929030 0.1264145212 0.1265856960 0.1269359683 0.1279701110 0.1291057560 0.1310494530 0.1341681400 0.1399114514 0.1485949061 0.1626958529 0.1842639865 0.2172577484 0.2679102226 0.3462634874 0.4709492628 0.6790687178 1.0218888187 1.3970213833 1.3500123307 1.0559040352 0.8124611210 0.6339908089 0.4976942821 0.3905409414 0.3052554975 0.2381072685 0.1851810115 0.1439712288 0.1115251549 0.0864442035 0.0669334048 0.0519296214 0.0401784020 0.0311702000 0.0240250661];
ang = [3.1057790605 3.0953943324 3.0819178234 3.0646029042 3.0425678626 3.0140787703 2.9780412602 2.9333880613 2.8780131322 2.8123147671 2.7378488132 2.6590836203 2.5844964422 2.5254382805 2.4948825215 2.5058007990 2.5747299425 2.7296687154 3.0338866910 -2.7108528721 -2.1164116230 -1.7606533149 -1.5954068330 -1.5260057377 -1.5029434828 -1.5014570108 -1.5087467081 -1.5187532592 -1.5283706207 -1.5371504451 -1.5444427408 -1.5502088582 -1.5545870469 -1.5583587922 -1.5611390804 -1.5631621091 -1.5648913718];

s = j*w;
H = mag.*exp(j*ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P = [P;t];
end
r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b, q(i)];
end

b = mat2str(b)

a=[];
for i=L+1:2*L
    a = [a,q(i)];
end

a = mat2str(a)