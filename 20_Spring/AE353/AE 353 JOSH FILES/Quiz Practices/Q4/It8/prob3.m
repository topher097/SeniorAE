clear, clc

L = 2;
w = [0.0100000000 0.0132194115 0.0174752840 0.0231012970 0.0305385551 0.0403701726 0.0533669923 0.0705480231 0.0932603347 0.1232846739 0.1629750835 0.2154434690 0.2848035868 0.3764935807 0.4977023564 0.6579332247 0.8697490026 1.1497569954 1.5199110830 2.0092330026 2.6560877829 3.5111917342 4.6415888336 6.1359072734 8.1113083079 10.7226722201 14.1747416293 18.7381742286 24.7707635599 32.7454916288 43.2876128108 57.2236765935 75.6463327555 100.0000000000];
mag = [0.7684500559 0.7685081000 0.7685637093 0.7685887843 0.7685095324 0.7686824107 0.7691222305 0.7691353108 0.7696285117 0.7702715670 0.7717703380 0.7739920426 0.7782684416 0.7852230379 0.7970717297 0.8159085572 0.8438982885 0.8792241914 0.9067509096 0.8879799003 0.7937253166 0.6479428374 0.5019126271 0.3807606058 0.2874684253 0.2168727296 0.1636493790 0.1236231748 0.0934657829 0.0707005583 0.0534840050 0.0404660667 0.0307398136 0.0230048988];
ang = [3.1286900096 3.1245485622 3.1190315800 3.1119472870 3.1025726530 3.0897888508 3.0733655835 3.0511102333 3.0221197349 2.9835507177 2.9329215325 2.8658516071 2.7773955623 2.6610252254 2.5083405786 2.3089561922 2.0498954741 1.7181775448 1.3047727648 0.8211597219 0.3209572380 -0.1242589942 -0.4793736869 -0.7497647673 -0.9523967309 -1.1043532303 -1.2185694429 -1.3046040143 -1.3695030648 -1.4186937856 -1.4557500095 -1.4837969719 -1.5051227985 -1.5211111945];

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    for j=1:L
        t = [t, s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    P = [P;t];
end

r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b, q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a, q(i)];
end
a = mat2str(a)