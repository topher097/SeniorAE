clear, clc
%% Provided data
L = 2;
w = [0.0100000000 0.0162377674 0.0263665090 0.0428133240 0.0695192796 0.1128837892 0.1832980711 0.2976351442 0.4832930239 0.7847599704 1.2742749857 2.0691380811 3.3598182863 5.4555947812 8.8586679041 14.3844988829 23.3572146909 37.9269019073 61.5848211066 100.0000000000];
mag = [0.6847674838 0.6847114045 0.6849472866 0.6853858515 0.6866301041 0.6890235542 0.6963664145 0.7145883019 0.7584848998 0.8526979867 1.0008450527 1.0834920067 0.9216965644 0.6408864410 0.4109589889 0.2564783173 0.1587333680 0.0976632059 0.0603048578 0.0373686224];
ang = [0.0033379267 0.0054619383 0.0087993041 0.0144567153 0.0232678732 0.0375462274 0.0592904823 0.0897771422 0.1207601948 0.1158288141 -0.0094311093 -0.3262020280 -0.7316644670 -1.0490302121 -1.2508128746 -1.3743979643 -1.4499214436 -1.4964864708 -1.5249320073 -1.5425633005];
%% Calculations
s = 1j * w;
H = mag .* exp(1j * ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P=[P;t];
end
r = [];
for i=1:length(H)
    r=[r;s(i)^L*H(i)];
end

P = [real(P);
     imag(P)];
r = [real(r);
     imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)