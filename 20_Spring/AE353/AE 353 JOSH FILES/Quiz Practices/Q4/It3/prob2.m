clear, clc

L = 2;
w = [0.0100000000 0.0149249555 0.0222754295 0.0332459793 0.0496194760 0.0740568469 0.1105295141 0.1649648074 0.2462092401 0.3674661941 0.5484416576 0.8185467307 1.2216773490 1.8233480009 2.7213387684 4.0615859884 6.0618989935 9.0473572423 13.5031403787 20.1533768594 30.0788251804 44.8925125822 67.0018750351 100.0000000000];
mag = [0.8636655358 0.8637686150 0.8636983642 0.8636866533 0.8640020333 0.8643354183 0.8652932644 0.8671167041 0.8711198003 0.8792687947 0.8928245973 0.9100430758 0.9180599390 0.8942592547 0.8184089636 0.6902341173 0.5355293010 0.3893186716 0.2718934218 0.1859814840 0.1256159415 0.0844800479 0.0568653845 0.0380808553];
ang = [3.1189184049 3.1074528580 3.0904151827 3.0653687158 3.0278081561 2.9719092917 2.8886929708 2.7657989633 2.5862072330 2.3302774794 1.9812183710 1.5412595877 1.0427192916 0.5357950355 0.0606730344 -0.3579375463 -0.7032981377 -0.9680221634 -1.1595552997 -1.2929780100 -1.3839847229 -1.4453947762 -1.4867677268 -1.5144325119];

s = j*w;
H = mag.*exp(j*ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P = [P;t];
end
r = [];
for i=1:length(H)
    r=[r;s(i)^L*H(i)];
end
P = [real(P);imag(P)];
r = [real(r);imag(r)];
q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)