clear, clc

L = 2;
w = [0.0100000000 0.0144543977 0.0208929613 0.0301995172 0.0436515832 0.0630957344 0.0912010839 0.1318256739 0.1905460718 0.2754228703 0.3981071706 0.5754399373 0.8317637711 1.2022644346 1.7378008287 2.5118864315 3.6307805477 5.2480746025 7.5857757503 10.9647819614 15.8489319246 22.9086765277 33.1131121483 47.8630092323 69.1830970919 100.0000000000];
mag = [1.8516123563 1.8517953762 1.8524224841 1.8537218441 1.8565867943 1.8618291504 1.8734937060 1.8976958812 1.9475880501 2.0489450979 2.2511133048 2.6331496931 3.2468678770 3.6941499832 3.0937032086 2.1129144144 1.4060290727 0.9483923303 0.6471654346 0.4449468798 0.3065657324 0.2119167692 0.1465278701 0.1012976881 0.0700089975 0.0483597781];
ang = [0.0245901912 0.0357463866 0.0513772108 0.0743170638 0.1074933945 0.1552681686 0.2241049431 0.3224878873 0.4629407653 0.6602128584 0.9328247548 1.3045650529 1.8211708653 2.5354626183 -3.0029958902 -2.4900966368 -2.1779872854 -1.9812336997 -1.8513471546 -1.7638091275 -1.7040405240 -1.6627980792 -1.6343795066 -1.6147774227 -1.6011427371 -1.5920395010];

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    for j = 1 : L
        t = [t, s(i)^(L-j)];
    end
    for j = 1 : L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    P = [P;t];
end

r = [];
for i = 1 : length(H)
    r = [r;s(i)^L * H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i = 1 : L
    b = [b, q(i)];
end

b = mat2str(b)

a = [];
for i = L + 1 : 2 * L
    a = [a, q(i)];
end

a = mat2str(a)