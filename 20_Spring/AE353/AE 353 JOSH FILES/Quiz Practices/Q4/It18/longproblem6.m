clear, clc

L = 2;
w = [0.0100000000 0.0132194115 0.0174752840 0.0231012970 0.0305385551 0.0403701726 0.0533669923 0.0705480231 0.0932603347 0.1232846739 0.1629750835 0.2154434690 0.2848035868 0.3764935807 0.4977023564 0.6579332247 0.8697490026 1.1497569954 1.5199110830 2.0092330026 2.6560877829 3.5111917342 4.6415888336 6.1359072734 8.1113083079 10.7226722201 14.1747416293 18.7381742286 24.7707635599 32.7454916288 43.2876128108 57.2236765935 75.6463327555 100.0000000000];
mag = [1.1760361675 1.1761622140 1.1761425697 1.1764421434 1.1768872429 1.1775135525 1.1782405350 1.1796469988 1.1823869004 1.1871834555 1.1955408441 1.2101446482 1.2354601018 1.2799128289 1.3570127116 1.4888122547 1.6982892176 1.9370033059 1.8959879345 1.4440309318 0.9965757706 0.6948309688 0.4977539270 0.3644689582 0.2703270027 0.2022715928 0.1518590078 0.1145263655 0.0864468537 0.0653918971 0.0493597034 0.0371926335 0.0281936866 0.0211995680];
ang = [0.0018025470 0.0024693014 0.0034066606 0.0044849168 0.0057186184 0.0076682780 0.0102975285 0.0134271914 0.0177822984 0.0229576244 0.0296231269 0.0373488055 0.0450840080 0.0498930915 0.0442244025 0.0096902876 -0.0945293194 -0.3400638897 -0.7476707285 -1.1224586138 -1.3349618483 -1.4389661124 -1.4910229364 -1.5189174305 -1.5351456578 -1.5454700231 -1.5521681289 -1.5570029999 -1.5605647960 -1.5631112862 -1.5648821743 -1.5663481883 -1.5674227447 -1.5684123207];

s=  j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    for j=1:L
        t = [t, s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    
    P = [P; t];
end

r = [];
for i=1:length(H)
    r = [r; s(i)^L * H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];
    
q = inv(P'*P)*P'*r;

b = [];
a = [];

for i=1:L
    b = [b, q(i)];
end
for i=1+L : 2*L
    a = [a, q(i)];
end

b = mat2str(b)
a = mat2str(a)