clear, clc

L = 2;
w = [0.0100000000 0.0149249555 0.0222754295 0.0332459793 0.0496194760 0.0740568469 0.1105295141 0.1649648074 0.2462092401 0.3674661941 0.5484416576 0.8185467307 1.2216773490 1.8233480009 2.7213387684 4.0615859884 6.0618989935 9.0473572423 13.5031403787 20.1533768594 30.0788251804 44.8925125822 67.0018750351 100.0000000000];
mag = [0.6199918339 0.6204160909 0.6209065077 0.6221662204 0.6252473379 0.6320236229 0.6465259048 0.6783650069 0.7445223397 0.8754457678 1.1175002460 1.5245549310 2.0611250312 2.2344093283 1.7277648195 1.1636930984 0.7700521461 0.5116049472 0.3416975223 0.2283717448 0.1528561888 0.1023869542 0.0685178453 0.0460217744];
ang = [0.0339570334 0.0510453332 0.0758385836 0.1131311408 0.1683458840 0.2498731878 0.3687714526 0.5373377634 0.7655491622 1.0548071688 1.4000925675 1.8177667657 2.3724645113 3.0800239600 -2.5935213580 -2.2147190692 -1.9879695875 -1.8457454082 -1.7535827391 -1.6927543455 -1.6523786972 -1.6255395082 -1.6075602777 -1.5953089862];

s= j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    
    for j=1:L
        t = [t, s(i)^(L-j)];
    end
    
    for j=1:L
        t = [t, -s(i)^(L-j) * H(i)];
    end
    P = [P; t];
end

r = [];
for i=1:length(H)
    r = [r; s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];
 
q = inv(P'*P)*P'*r;

b = [];
a = [];

for i=1:L
    b = [b,q(i)];
end

for i=1+L:2*j
    a = [a, q(i)];
end

b = mat2str(b)
a = mat2str(a)
