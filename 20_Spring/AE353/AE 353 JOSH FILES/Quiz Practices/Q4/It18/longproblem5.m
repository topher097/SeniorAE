clear, clc

L = 3;
w = [0.0100000000 0.0151991108 0.0231012970 0.0351119173 0.0533669923 0.0811130831 0.1232846739 0.1873817423 0.2848035868 0.4328761281 0.6579332247 1.0000000000 1.5199110830 2.3101297001 3.5111917342 5.3366992312 8.1113083079 12.3284673944 18.7381742286 28.4803586844 43.2876128108 65.7933224658 100.0000000000];
mag = [2.0765566032 2.0767101556 2.0781530120 2.0804804670 2.0864465863 2.0999046192 2.1312147549 2.2023773311 2.3623980163 2.6955920712 3.1598773143 2.9003244713 1.9604151281 1.3013661367 0.8955509585 0.6176247796 0.4191127919 0.2804459875 0.1856510584 0.1227316028 0.0809432587 0.0532558630 0.0349776453];
ang = [3.1415658502 3.1414784229 3.1417034231 -3.1415039285 -3.1413301463 -3.1406758026 -3.1377469618 -3.1277082642 -3.0935053917 -2.9816941195 -2.6621859207 -2.1042175436 -1.6925618103 -1.5114148706 -1.4548244662 -1.4584870696 -1.4831452850 -1.5084061891 -1.5284097609 -1.5425042316 -1.5520606181 -1.5582942256 -1.5628061545];

s= j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    for j = 1:L
        t = [t, s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j) * H(i)];
    end
    P = [P;t];
end

r = [];
for i=1:length(H)
    r = [r; s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;

b = [];
a = [];

for i=1:L
    b = [b, q(i)];
end

for i=1+L : 2*L
    a = [a, q(i)];
end

b = mat2str(b)
a = mat2str(a)
