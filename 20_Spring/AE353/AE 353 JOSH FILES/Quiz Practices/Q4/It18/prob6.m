clear, clc

L = 2;
w = [0.0100000000 0.0140652724 0.0197831888 0.0278255940 0.0391374560 0.0550478981 0.0774263683 0.1089022962 0.1531740464 0.2154434690 0.3030271083 0.4262158829 0.5994842503 0.8431909293 1.1859710123 1.6681005372 2.3462288481 3.3000347911 4.6415888336 6.5285211411 9.1825428357 12.9154966501 18.1659978838 25.5509709035 35.9381366380 50.5479682119 71.0970943231 100.0000000000];
mag = [3.0422372741 3.0410662495 3.0391517449 3.0351022255 3.0277998127 3.0130224923 2.9842533171 2.9299321059 2.8314449177 2.6637584015 2.4096379864 2.0776071490 1.7129052687 1.3744174618 1.0993894725 0.8923773524 0.7367298264 0.6087438231 0.4922199092 0.3846758588 0.2903751005 0.2137664343 0.1548804114 0.1112654744 0.0795520955 0.0567958567 0.0402700404 0.0285064641];
ang = [-0.0227097741 -0.0320143951 -0.0448304828 -0.0630934864 -0.0886252152 -0.1242598007 -0.1732773065 -0.2402398927 -0.3283035113 -0.4388162373 -0.5651768622 -0.6928884222 -0.8009630333 -0.8754235679 -0.9159574611 -0.9395868386 -0.9703997737 -1.0264707669 -1.1082097572 -1.2011192843 -1.2890205961 -1.3625942929 -1.4197705015 -1.4622023035 -1.4930953896 -1.5154741645 -1.5314248153 -1.5427039994];

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    
    for j = 1:L
        t = [t, s(i)^(L-j)];
    end
    for j = 1:L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    P = [P; t];
end

r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;

b = [];
for i=1:L
    b = [b,q(i)];
end

b = mat2str(b)

a = [];
for i=L+1 : 2*L
    a = [a, q(i)];
end

a = mat2str(a)