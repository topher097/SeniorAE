clear, clc

L = 3;
w = [0.0100000000 0.0162377674 0.0263665090 0.0428133240 0.0695192796 0.1128837892 0.1832980711 0.2976351442 0.4832930239 0.7847599704 1.2742749857 2.0691380811 3.3598182863 5.4555947812 8.8586679041 14.3844988829 23.3572146909 37.9269019073 61.5848211066 100.0000000000];
mag = [1.5342212014 1.5340764791 1.5335658838 1.5323741665 1.5297265984 1.5211101739 1.4955219639 1.4084994408 1.1346118196 0.6543854688 0.3211369077 0.2176242104 0.1915571059 0.1629443758 0.1238833026 0.0848267251 0.0547695481 0.0345127116 0.0212029750 0.0131920062];
ang = [0.0339542417 0.0550219185 0.0894369060 0.1450677025 0.2362706748 0.3852002927 0.6319844732 1.0467127907 1.7176001172 2.6007523747 -2.7222123751 -1.8495616322 -1.3934876569 -1.2694876732 -1.3021618757 -1.3771180433 -1.4438643931 -1.4906862419 -1.5210701140 -1.5401259416];

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    for j=1:L
        t = [t, s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    P = [P; t];
end

r = [];
for i=1:length(H)
    r = [r; s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;

b = [];
a = [];
for i=1:L
    b = [b, q(i)];
end
for i=1+L:2*L
    a = [a, q(i)];
end

b = mat2str(b)
a = mat2str(a)