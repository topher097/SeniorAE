clear, clc

L = 3;
w = [0.0100000000 0.0134596032 0.0181160919 0.0243835410 0.0328192787 0.0441734470 0.0594557071 0.0800250228 0.1077105056 0.1449740670 0.1951293423 0.2626363528 0.3534981105 0.4757944314 0.6404004271 0.8619535665 1.1601553017 1.5615230060 2.1017480113 2.8288694346 3.8075460212 5.1248058770 6.8977853794 9.2841454452 12.4960914129 16.8192432488 22.6380340952 30.4698957090 41.0112707055 55.1995432128 74.2963950759 100.0000000000];
mag = [0.1305719968 0.1304871476 0.1306238467 0.1308373024 0.1312850488 0.1321595590 0.1333834197 0.1358711946 0.1398963537 0.1476109801 0.1609640320 0.1837929817 0.2231501854 0.2909129590 0.4103586765 0.6318480381 1.0402264663 1.4618905229 1.2558494894 0.8973813138 0.6464805481 0.4740132534 0.3501594894 0.2596122218 0.1924803204 0.1431629860 0.1063047283 0.0788131962 0.0584453462 0.0436154811 0.0323058800 0.0240888984];
ang = [3.1089794228 3.0978633294 3.0827208581 3.0623497800 3.0352970150 2.9990069022 2.9507483428 2.8873359246 2.8055956994 2.7026375668 2.5792731353 2.4393552024 2.2891244029 2.1322081210 1.9565195795 1.7183665760 1.3069496795 0.5695286168 -0.1755041028 -0.6140902605 -0.8801410091 -1.0618703117 -1.1936701177 -1.2905330270 -1.3627240127 -1.4162412713 -1.4557960918 -1.4853630670 -1.5073641338 -1.5237647444 -1.5358972230 -1.5449444186];

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    
    for j=1:L
        t = [t, s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j) * H(i)];
    end
    P = [P; t];
end

r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end
P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end

b = mat2str(b)

a = [];
for i=L+1:2*L
    a = [a,q(i)];
end

a = mat2str(a)