clear, clc

L = 2;
w = [0.0100000000 0.0137382380 0.0188739182 0.0259294380 0.0356224789 0.0489390092 0.0672335754 0.0923670857 0.1268961003 0.1743328822 0.2395026620 0.3290344562 0.4520353656 0.6210169419 0.8531678524 1.1721022975 1.6102620276 2.2122162911 3.0391953823 4.1753189366 5.7361525104 7.8804628157 10.8263673387 14.8735210729 20.4335971786 28.0721620394 38.5662042116 52.9831690628 72.7895384398 100.0000000000];
mag = [1.0814603401 1.0814213725 1.0818574226 1.0817334739 1.0815167550 1.0816078827 1.0816604364 1.0815103187 1.0814089372 1.0809297670 1.0804915487 1.0793501801 1.0764565333 1.0708109132 1.0567852052 1.0233946346 0.9522476739 0.8290304824 0.6695823665 0.5117740850 0.3799829191 0.2787352800 0.2035102577 0.1482560069 0.1081682153 0.0786034424 0.0571677843 0.0417749578 0.0303779489 0.0220613887];
ang = [0.0132912689 0.0181773013 0.0251017432 0.0343493411 0.0473353520 0.0648224012 0.0892733128 0.1225632663 0.1682271318 0.2313841414 0.3175107269 0.4353845196 0.5961489742 0.8140562649 1.1047533994 1.4814638467 1.9427158884 2.4542144558 2.9530543129 -2.8994996774 -2.5565474101 -2.2953533181 -2.1008751821 -1.9576043341 -1.8530652104 -1.7763029734 -1.7203892207 -1.6796928071 -1.6501331124 -1.6284565198];

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    P = [P;t];
end
r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;

b = [];
for i=1:L
    b = [b, q(i)];
end
b = mat2str(b)

a = [];
for i=L+1:2*L
    a = [a, q(i)];
end
a = mat2str(a)