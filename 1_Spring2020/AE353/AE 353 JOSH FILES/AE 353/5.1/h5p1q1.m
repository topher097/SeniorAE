function FindCost
A = [-0.70000000 0.00000000 0.80000000 0.90000000; -0.20000000 0.30000000 0.50000000 0.10000000; -0.70000000 0.00000000 -0.70000000 -0.40000000; 0.10000000 0.60000000 -0.60000000 0.20000000];
B = [0.90000000; -0.50000000; -0.90000000; 0.40000000];
K = [1.59549829 -3.09826607 -1.31805252 -2.00332191];
Q = [0.97000000 0.00000000 0.00000000 0.00000000; 0.00000000 0.75000000 0.00000000 0.00000000; 0.00000000 0.00000000 0.82000000 0.00000000; 0.00000000 0.00000000 0.00000000 0.74000000];
R = [0.56000000];
M = [0.98000000 0.00000000 0.00000000 0.00000000; 0.00000000 0.61000000 0.00000000 0.00000000; 0.00000000 0.00000000 0.68000000 0.00000000; 0.00000000 0.00000000 0.00000000 0.50000000];
t0 = 0.60000000;
x0 = [0.94000000; -0.24000000; 0.06000000; 0.11000000];
t1 = 2.50000000;
x1 = expm((A - B*K)*(t1-t0))*x0
cost = integral(@(t) integrand(t, A, B, K, t0, x0, Q, R), t0, t1) + transpose(x1)*M*x1;
disp(mat2str(cost, 8));
end

function cost = integrand(t, A, B, K, t0, x0, Q, R)
cost = zeros(size(t));
for i = 1:length(t)
    x = expm((A - B * K) * (t(i) - t0)) * x0;
    u = -K * x;
    cost(i) = transpose(x)*Q*x + transpose(u)*R*u;
end
end