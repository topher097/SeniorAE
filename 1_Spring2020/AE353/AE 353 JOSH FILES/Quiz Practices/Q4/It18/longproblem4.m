clear, clc

L = 2;
w = [0.0100000000 0.0134596032 0.0181160919 0.0243835410 0.0328192787 0.0441734470 0.0594557071 0.0800250228 0.1077105056 0.1449740670 0.1951293423 0.2626363528 0.3534981105 0.4757944314 0.6404004271 0.8619535665 1.1601553017 1.5615230060 2.1017480113 2.8288694346 3.8075460212 5.1248058770 6.8977853794 9.2841454452 12.4960914129 16.8192432488 22.6380340952 30.4698957090 41.0112707055 55.1995432128 74.2963950759 100.0000000000];
mag = [1.2551612677 1.2551677639 1.2551307058 1.2550975748 1.2550561888 1.2555052397 1.2560287936 1.2567268237 1.2581876292 1.2610137915 1.2658411327 1.2745747379 1.2903614992 1.3190266086 1.3702614859 1.4605128970 1.6048789216 1.7524467479 1.6242868541 1.1596272101 0.7580392944 0.5079867660 0.3531623370 0.2523486525 0.1832787121 0.1344999615 0.0991838470 0.0731308265 0.0543276263 0.0404130723 0.0301576309 0.0220590473];
ang = [0.0096017373 0.0128629263 0.0170374539 0.0231713433 0.0311585552 0.0417063235 0.0564302505 0.0758354504 0.1022358419 0.1375481966 0.1851728618 0.2497799466 0.3374186836 0.4570450940 0.6220934770 0.8557441770 1.1989935725 1.7210093307 2.4297775286 3.0923058637 -2.7272223421 -2.4122948727 -2.1899054822 -2.0289918921 -1.9103392395 -1.8229314487 -1.7576697054 -1.7097871610 -1.6740526722 -1.6474589642 -1.6277447850 -1.6130801185];

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    for j=1:L
        t = [t, s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    P = [P; t];
end

r = [];
for i=1:length(H)
    r = [r; s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;
b = [];
a = [];

for i=1:L
    b = [b, q(i)];
end

for i=1+L:2*L
    a = [a, q(i)];
end

b = mat2str(b)
a = mat2str(a)
