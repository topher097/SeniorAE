clear, clc

L = 3;
w = [0.0100000000 0.0122167735 0.0149249555 0.0182334800 0.0222754295 0.0272133877 0.0332459793 0.0406158599 0.0496194760 0.0606189899 0.0740568469 0.0904735724 0.1105295141 0.1350314038 0.1649648074 0.2015337686 0.2462092401 0.3007882518 0.3674661941 0.4489251258 0.5484416576 0.6700187504 0.8185467307 1.0000000000 1.2216773490 1.4924955451 1.8233480009 2.2275429520 2.7213387684 3.3245979323 4.0615859884 4.9619476030 6.0618989935 7.4056846923 9.0473572423 11.0529514113 13.5031403787 16.4964807410 20.1533768594 24.6209240149 30.0788251804 36.7466194074 44.8925125822 54.8441657612 67.0018750351 81.8546730707 100.0000000000];
mag = [1.3537875215 1.3537566488 1.3536323678 1.3534167803 1.3529823801 1.3525292376 1.3521632855 1.3512402071 1.3500233120 1.3478053639 1.3447822655 1.3403132042 1.3335430534 1.3237613181 1.3086415109 1.2863512540 1.2527179021 1.2026081365 1.1278908220 1.0175981462 0.8580320661 0.6410898438 0.4018738016 0.3520900424 0.5742311637 0.7910060495 0.9110620487 0.9386699195 0.9000359215 0.8224409027 0.7270374970 0.6276201245 0.5328689280 0.4472241579 0.3724272268 0.3084366182 0.2543953060 0.2093312239 0.1721511258 0.1413597900 0.1157205908 0.0947848763 0.0777502269 0.0635976635 0.0522293570 0.0426642727 0.0349976057];
ang = [-0.0148598262 -0.0180850603 -0.0222014935 -0.0272482628 -0.0330577202 -0.0403980218 -0.0495175782 -0.0603577142 -0.0738671549 -0.0901195192 -0.1103569709 -0.1347556685 -0.1644079837 -0.2007937759 -0.2451714923 -0.2992217523 -0.3651611932 -0.4444897461 -0.5394975093 -0.6491427450 -0.7647033673 -0.8440415773 -0.6988022430 -0.0050518442 0.2591041709 0.1348357701 -0.0738897799 -0.2872856105 -0.4841195615 -0.6588369411 -0.8104315374 -0.9400263723 -1.0496726151 -1.1414668512 -1.2178926740 -1.2808336534 -1.3329909396 -1.3760211096 -1.4111310317 -1.4399640110 -1.4635858472 -1.4832319089 -1.4990142709 -1.5119862139 -1.5227234534 -1.5314635604 -1.5384326484];

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t = [];
    
    for j=1:L
        t = [t, s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j) * H(i)];
    end
    P = [P;t];
end

r= [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b, q(i)];
end
a = [];
for i=1+L : 2*L
    a = [a, q(i)];
end

b = mat2str(b)
a = mat2str(a)