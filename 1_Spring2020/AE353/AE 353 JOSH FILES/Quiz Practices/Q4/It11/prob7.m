clear, clc
L = 2;
w = [0.0100000000 0.0135935639 0.0184784980 0.0251188643 0.0341454887 0.0464158883 0.0630957344 0.0857695899 0.1165914401 0.1584893192 0.2154434690 0.2928644565 0.3981071706 0.5411695265 0.7356422545 1.0000000000 1.3593563909 1.8478497974 2.5118864315 3.4145488738 4.6415888336 6.3095734448 8.5769589859 11.6591440118 15.8489319246 21.5443469003 29.2864456463 39.8107170553 54.1169526546 73.5642254460 100.0000000000];
mag = [0.8906429054 0.8904742984 0.8903863261 0.8902840634 0.8903773582 0.8901073701 0.8896797451 0.8890447045 0.8880521587 0.8858186038 0.8820435949 0.8750380517 0.8622999850 0.8402372096 0.8031329546 0.7452099614 0.6631007386 0.5608796950 0.4505145281 0.3469567895 0.2598424588 0.1921076114 0.1409974341 0.1036834732 0.0760060510 0.0559400005 0.0411831445 0.0304271132 0.0222113597 0.0164754514 0.0120266956];
ang = [3.1294807703 3.1249618690 3.1190215944 3.1108260568 3.0998285358 3.0848575746 3.0645617691 3.0366201577 2.9989959968 2.9481101718 2.8792163157 2.7856471762 2.6604372834 2.4942847269 2.2772676331 2.0012772017 1.6646054104 1.2744116665 0.8494634405 0.4183245207 0.0115894700 -0.3455524661 -0.6404891774 -0.8739361545 -1.0528658024 -1.1874165495 -1.2880502539 -1.3622648989 -1.4173020225 -1.4577537867 -1.4876042632];

s = j*w;
H = mag.*exp(j*ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P = [P;t];
end
r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end

b = mat2str(b)

a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)