clear, clc

w = [0.0100000000 0.0133352143 0.0177827941 0.0237137371 0.0316227766 0.0421696503 0.0562341325 0.0749894209 0.1000000000 0.1333521432 0.1778279410 0.2371373706 0.3162277660 0.4216965034 0.5623413252 0.7498942093 1.0000000000 1.3335214322 1.7782794100 2.3713737057 3.1622776602 4.2169650343 5.6234132519 7.4989420933 10.0000000000 13.3352143216 17.7827941004 23.7137370566 31.6227766017 42.1696503429 56.2341325190 74.9894209332 100.0000000000];
mag = [2.0422414403 2.0425964186 2.0425957881 2.0424589129 2.0425562503 2.0428124892 2.0432467803 2.0437807260 2.0450654725 2.0470763744 2.0502362681 2.0547583199 2.0610930567 2.0654613741 2.0606793283 2.0313463454 1.9561256016 1.8189318227 1.6197504553 1.3786402257 1.1274114335 0.8932912946 0.6931026105 0.5300761321 0.4024673230 0.3038643737 0.2286066613 0.1718412059 0.1288901116 0.0966322961 0.0726717578 0.0544763536 0.0407075652];
ang = [-3.1378543756 -3.1366562554 -3.1352902620 -3.1330568118 -3.1299117782 -3.1261936663 -3.1211268544 -3.1141214373 -3.1047400208 -3.0921929706 -3.0746959390 -3.0508317639 -3.0170301845 -2.9684073277 -2.8998269700 -2.8062278495 -2.6862280776 -2.5439921964 -2.3903874280 -2.2385448694 -2.0998398882 -1.9817579103 -1.8853136490 -1.8098044217 -1.7514274545 -1.7064253258 -1.6730184937 -1.6475357242 -1.6284177951 -1.6138986443 -1.6031708726 -1.5951595852 -1.5891486769];
L = 2;

s = j*w;
H = mag.*exp(j*ang);
P = [];

for i=1:length(H)
    t=  [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P = [P; t];
end

r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end

P = [real(P); imag(P)];
r = [real(r); imag(r)];

q = inv(P'*P)*P'*r;
b = [];

for i=1:L
    b = [b, q(i)];
end
b = mat2str(b)

a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)