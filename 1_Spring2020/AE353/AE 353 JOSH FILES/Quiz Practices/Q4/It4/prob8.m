clear, clc

L = 2;
w = [0.0100000000 0.0131113394 0.0171907220 0.0225393390 0.0295520924 0.0387467512 0.0508021805 0.0666084629 0.0873326162 0.1145047570 0.1501310729 0.1968419447 0.2580861540 0.3383855153 0.4436687331 0.5817091329 0.7626985859 1.0000000000 1.3111339374 1.7190722019 2.2539339047 2.9552092352 3.8746751205 5.0802180469 6.6608462908 8.7332616238 11.4504756994 15.0131072891 19.6841944729 25.8086154042 33.8385515343 44.3668733098 58.1709132937 76.2698585902 100.0000000000];
mag = [0.8208644470 0.8210766816 0.8210190530 0.8215359781 0.8215609121 0.8218279893 0.8222771582 0.8233043882 0.8248676961 0.8274000856 0.8319264431 0.8396025091 0.8526769889 0.8750142219 0.9122182177 0.9735831791 1.0718664839 1.2185815987 1.4021480898 1.5253014709 1.4254446082 1.1452636280 0.8624647437 0.6420435905 0.4803634422 0.3615681520 0.2737463160 0.2075960804 0.1579113522 0.1201860686 0.0916945633 0.0696579303 0.0532542267 0.0405910175 0.0310289373];
ang = [3.1254492667 3.1202897465 3.1139763064 3.1051704559 3.0936833193 3.0785672301 3.0593582038 3.0338249236 3.0001185414 2.9564155504 2.8993994565 2.8244586048 2.7273036634 2.6023794041 2.4416867247 2.2377151800 1.9807854611 1.6559742190 1.2401928753 0.7214355760 0.1629867117 -0.3091159148 -0.6507602028 -0.8909216566 -1.0622815309 -1.1874828045 -1.2805623563 -1.3501922444 -1.4029767633 -1.4430926982 -1.4733606359 -1.4967189241 -1.5141045225 -1.5276143612 -1.5378342398];

s = j*w;
H = mag.*exp(j*ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    P = [P;t];
end
r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end
P = [real(P); imag(P)];
r = [real(r); imag(r)];
q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b, q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a, q(i)];
end
a = mat2str(a)