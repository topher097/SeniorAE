clear, clc

L = 3;
w = [0.0100000000 0.0124519708 0.0155051578 0.0193069773 0.0240409918 0.0299357729 0.0372759372 0.0464158883 0.0577969288 0.0719685673 0.0896150502 0.1115883993 0.1389495494 0.1730195739 0.2154434690 0.2682695795 0.3340484984 0.4159562163 0.5179474679 0.6449466771 0.8030857221 1.0000000000 1.2451970847 1.5505157798 1.9306977289 2.4040991835 2.9935772947 3.7275937203 4.6415888336 5.7796928842 7.1968567300 8.9615050195 11.1588399251 13.8949549437 17.3019573885 21.5443469003 26.8269579528 33.4048498351 41.5956216307 51.7947467923 64.4946677104 80.3085722139 100.0000000000];
mag = [0.4183102836 0.4185104786 0.4184610406 0.4187562738 0.4193178604 0.4194712386 0.4203635739 0.4213996270 0.4231220481 0.4257651549 0.4301785696 0.4366659965 0.4469145981 0.4627206225 0.4872014940 0.5261441283 0.5865955742 0.6818350145 0.8309520766 1.0576732207 1.3653050095 1.6645376040 1.7757331754 1.6842538483 1.5191014454 1.3503944885 1.1915627690 1.0402292082 0.8956248692 0.7595315596 0.6351085002 0.5247922484 0.4301585794 0.3499653237 0.2837034930 0.2291867750 0.1847694099 0.1484783391 0.1195401035 0.0962343293 0.0772133510 0.0620079764 0.0500246962];
ang = [3.1250271691 3.1209110128 3.1158563812 3.1098243735 3.1017113590 3.0919724038 3.0797116905 3.0649557566 3.0460487063 3.0226151936 2.9935078488 2.9577213944 2.9129065409 2.8578905660 2.7896145814 2.7052313580 2.6002879881 2.4673732366 2.2939992815 2.0584825535 1.7313899419 1.3024344392 0.8373998277 0.4334102858 0.1157273792 -0.1396392177 -0.3555109335 -0.5443892496 -0.7114480346 -0.8583167201 -0.9845970823 -1.0922037179 -1.1818999673 -1.2562279167 -1.3168505749 -1.3661788886 -1.4059825196 -1.4382213833 -1.4642927281 -1.4852794580 -1.5020604837 -1.5156409726 -1.5265793217];

s = 1j * w;
H = mag .* exp(1j * ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P=[P;t];
end
r = [];
for i=1:length(H)
    r=[r;s(i)^L*H(i)];
end

P = [real(P);
     imag(P)];
r = [real(r);
     imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)