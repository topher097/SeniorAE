clear, clc
%% Data:
L = 3;
w = [0.0100000000 0.0134596032 0.0181160919 0.0243835410 0.0328192787 0.0441734470 0.0594557071 0.0800250228 0.1077105056 0.1449740670 0.1951293423 0.2626363528 0.3534981105 0.4757944314 0.6404004271 0.8619535665 1.1601553017 1.5615230060 2.1017480113 2.8288694346 3.8075460212 5.1248058770 6.8977853794 9.2841454452 12.4960914129 16.8192432488 22.6380340952 30.4698957090 41.0112707055 55.1995432128 74.2963950759 100.0000000000];
mag = [0.1774348338 0.1773969397 0.1776545762 0.1777801797 0.1781579126 0.1787796187 0.1800836713 0.1824300367 0.1862482129 0.1935105425 0.2067259631 0.2305123756 0.2745906426 0.3557312190 0.5041699688 0.7294713516 0.8752203690 0.8174937459 0.7097928755 0.6154004808 0.5297554071 0.4452394668 0.3627647736 0.2867672401 0.2215432936 0.1686466149 0.1268654423 0.0951609542 0.0709333446 0.0529750595 0.0392125386 0.0292278353];
ang = [3.1399478981 3.1394227367 3.1384531049 3.1374267246 3.1362104421 3.1343910211 3.1324701684 3.1300479474 3.1282439665 3.1284887353 3.1345766924 -3.1273494739 -3.0750741266 -2.9626525743 -2.7399634146 -2.3338291472 -1.7776674020 -1.3428540820 -1.1233704388 -1.0469798634 -1.0545060068 -1.1092919423 -1.1847164716 -1.2619386714 -1.3311183269 -1.3881699507 -1.4332637107 -1.4675966474 -1.4939429000 -1.5134878678 -1.5281443290 -1.5392157839];
syms s
%% Calculations
s = j*w;
H = mag .* exp(j*ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t, -s(i)^(L-j)*H(i)];
    end
    P = [P;t];
end
r = [];
for i=1:length(H)
    r = [r;s(i)^L*H(i)];
end
P = [real(P); imag(P)];
r = [real(r); imag(r)];
q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)