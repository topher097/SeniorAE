clear, clc
%% Insert provided data
L = 2;
w = [0.0100000000 0.0125892541 0.0158489319 0.0199526231 0.0251188643 0.0316227766 0.0398107171 0.0501187234 0.0630957344 0.0794328235 0.1000000000 0.1258925412 0.1584893192 0.1995262315 0.2511886432 0.3162277660 0.3981071706 0.5011872336 0.6309573445 0.7943282347 1.0000000000 1.2589254118 1.5848931925 1.9952623150 2.5118864315 3.1622776602 3.9810717055 5.0118723363 6.3095734448 7.9432823472 10.0000000000 12.5892541179 15.8489319246 19.9526231497 25.1188643151 31.6227766017 39.8107170553 50.1187233627 63.0957344480 79.4328234724 100.0000000000];
mag = [0.9321233569 0.9322203858 0.9324115967 0.9324360649 0.9324967182 0.9325732598 0.9325662779 0.9328044453 0.9330719443 0.9336141496 0.9343174722 0.9354201554 0.9371424134 0.9402349107 0.9449127980 0.9519274996 0.9628502755 0.9795402574 1.0036960644 1.0371349425 1.0778872926 1.1173251170 1.1311695651 1.0875721557 0.9755723483 0.8240027768 0.6703078601 0.5358728649 0.4255757755 0.3374004647 0.2674697886 0.2121165967 0.1683516359 0.1337232497 0.1059493844 0.0840393929 0.0667421028 0.0530769039 0.0421596917 0.0334270226 0.0265243599];
ang = [-0.0004477102 -0.0005852188 -0.0007416756 -0.0007061729 -0.0009075597 -0.0012643220 -0.0014978979 -0.0020105516 -0.0023608233 -0.0030318656 -0.0040074203 -0.0051899304 -0.0064815470 -0.0088246029 -0.0121279313 -0.0169167602 -0.0249274532 -0.0380778479 -0.0605202488 -0.0986996275 -0.1635291639 -0.2663846658 -0.4162246723 -0.6051793176 -0.8042444729 -0.9809519865 -1.1212010426 -1.2265672370 -1.3048981763 -1.3639838798 -1.4085024266 -1.4430914674 -1.4697864741 -1.4912326321 -1.5073890756 -1.5207349103 -1.5309308682 -1.5390497619 -1.5456051809 -1.5509330996 -1.5550705948];

%% Calculations:
s = 1j * w;
H = mag .* exp(1j * ang);
P = [];
for i=1:length(H)
    t = [];
    for j=1:L
        t = [t,s(i)^(L-j)];
    end
    for j=1:L
        t = [t,-s(i)^(L-j)*H(i)];
    end
    P=[P;t];
end
r = [];
for i=1:length(H)
    r=[r;s(i)^L*H(i)];
end

P = [real(P);
     imag(P)];
r = [real(r);
     imag(r)];

q = inv(P'*P)*P'*r;
b = [];
for i=1:L
    b = [b,q(i)];
end
b = mat2str(b)
a = [];
for i=L+1:2*L
    a = [a,q(i)];
end
a = mat2str(a)